@page
@model NetflixLibrosRazor.Pages.Libros.IndexLibrosModel
@{
    ViewData["Title"] = "Netflix de Libros";
}

<link rel="stylesheet" href="~/css/libros.css" asp-append-version="true" />

<header>
    <h1>Netflix de Libros</h1>
    <p>Explora una selección de libros recomendados.</p>

        <div class="menu-container">
            <div class="hamburger">&#9776;</div>
            <nav class="menu">
                <a href="/Libros/Crear"> Crear Libro</a>
                <a href="/" onclick="return confirm('¿Deseas cerrar sesión?');"> Cerrar Sesión</a>
            </nav>
        </div>
    </div>

            <form method="get" class="search-wrapper">
                <input type="text" name="SearchTerm" value="@Model.SearchTerm" placeholder="Buscar libro..." />
                <button type="submit" class="search-icon">
                    <i class="fa fa-search"></i>
                </button>
            </form>
</header>

<section class="libros">
    @foreach (var libro in Model.Libros)
    {
        <article class="libro" onclick="mostrarDetalles('libro_@libro.IdLibro')">
            <img src="@libro.Imagen" alt="@libro.Titulo" />
            <h2>@libro.Titulo</h2>

            <div id="libro_@libro.IdLibro" class="detalles" style="display:none;">
                <a href="@libro.UrlLibro" target="_blank">Leer libro</a>
                <p><strong>Autor:</strong> @libro.Autor</p>
                <p><strong>Género:</strong> @libro.Genero</p>
                <p><strong>Sinopsis:</strong> @libro.Sinopsis</p>

                <!-- Botón Eliminar solo para administrador (rol = 1) -->
                @if (Model.RolUsuario == (int)NetflixLibrosRazor.Models.RolUsuario.Administrador)
                {
                    <form method="post" asp-page-handler="Eliminar" asp-route-id="@libro.IdLibro"
                          onsubmit="return confirm('¿Estás seguro de que quieres eliminar este libro? Esta acción no se puede deshacer.');">
                        <button type="submit" class="btn-eliminar">Eliminar Libro</button>
                    </form>
                }
            </div>
        </article>
    }
</section>

<script>
    const hamburger = document.querySelector('.hamburger');
    const menu = document.querySelector('.menu');

    hamburger.addEventListener('click', () => {
        menu.classList.toggle('active');
    });

    function mostrarDetalles(id) {
        const detalles = document.getElementById(id);
        detalles.style.display = detalles.style.display === "none" ? "block" : "none";
    }
</script>
